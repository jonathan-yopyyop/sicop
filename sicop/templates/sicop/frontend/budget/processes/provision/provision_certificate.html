{% extends 'sicop/frontend/base/base.html' %}

{% load static %}
{% load i18n %}
{% load humanize %}
{% block page_title %}
  {% trans 'Budget provision list' %}
{% endblock page_title %}
{% block content %}
  <!-- App invoice wrapper -->
  <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
  <section class="app-invoice-wrapper">
    <div class="row">
        <div class="col-xl-9 col-md-8 col-12 printable-content">
            <!-- using a bootstrap card -->
            <div class="card">
                <!-- card body -->
                <div class="card-body p-2">
                    <!-- card-header -->
                    <div class="card-header px-0">
                        <div class="row">
                            <div class="col-md-12 col-lg-7 col-xl-4 mb-50">
                                <span class="invoice-id font-weight-bold">CAP#</span>
                                <span>{{provision_cart.id}}</span>
                            </div>
                            <div class="col-md-12 col-lg-5 col-xl-8">
                                <div class="d-flex align-items-center justify-content-end justify-content-xs-start">
                                    <div class="issue-date pr-2">
                                        <span class="font-weight-bold no-wrap">{% trans "Creation date" %}: </span>
                                        <span>{{provision_cart.updated_at}}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- invoice logo and title -->
                    <div class="invoice-logo-title row py-2">
                        <div class="col-6 d-flex flex-column justify-content-center align-items-start">
                            <h2 class="text-primary">{{provision_cart.project}}</h2>
                        </div>
                        <div class="col-6 d-flex justify-content-end invoice-logo">
                            <div id="qrcode"></div>
                        </div>
                    </div>
                    <hr>

                    <!-- invoice address and contacts -->
                    <div class="row invoice-adress-info py-2">
                        <div class="col-6 mt-1 from-info">
                            <div class="company-name mb-1">
                                <span class="text-muted">{% trans "Name" %}: {{provision_cart.project.name}}</span>
                            </div>
                            <div class="company-address mb-1">
                                <span class="text-muted">{% trans "Description" %}: {{provision_cart.project.description}}</span>
                            </div>
                            <div class="company-email  mb-1 mb-1">
                                <span class="text-muted">{% trans "Start at" %}: {{provision_cart.project.start_date}}</span>
                            </div>
                            <div class="company-phone  mb-1">
                                <span class="text-muted">{% trans "End at" %}: {{provision_cart.project.end_date}}</span>
                            </div>
                            <div class="company-phone  mb-1">
                                <span class="text-muted">{% trans "Budget" %}: ${{provision_cart.project.budget|intcomma}}</span>
                            </div>
                        </div>
                        <div class="col-6 mt-1 to-info">
                            <div class="company-name mb-1">
                                <span class="text-muted">{% trans "Project status" %}: {{provision_cart.project.project_status}}</span>
                            </div>
                            <div class="company-address mb-1">
                                <span class="text-muted">{% trans "Project type" %}: {{provision_cart.project}}</span>
                            </div>
                            <div class="company-email mb-1">
                                <span class="text-muted">{% trans "Is it taxable?" %}: 
                                {% if provision_cart.project.is_it_taxable %}
                                    {% trans "Yes" %}
                                {% else %}
                                    {% trans "No" %}
                                {% endif %}
                                </span>
                            </div>
                            <div class="company-phone  mb-1">
                                <span class="text-muted">{% trans "Project manager" %}: {{provision_cart.project.project_manager.name}}</span>
                            </div>
                        </div>
                    </div>

                    <!--product details table -->
                    <div class="product-details-table py-2 table-responsive">
                        <table class="table table-borderless">
                            <thead>
                                <tr>
                                    <th>{% trans 'Item' %}</th>
                                    <th>{% trans 'Taked' %}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for provision_cart_budget in provision_cart.provision_cart_provision_budgets.all %}
                                <tr>
                                    <td>{{provision_cart_budget.budget}}</td>
                                    <td class="font-weight-bold">$ {{provision_cart_budget.provosioned_amount|intcomma}}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    <hr>

                    <!-- invoice total -->
                    <div class="invoice-total py-2">
                        <div class="row">
                            <div class="col-4 col-sm-6 mt-75">
                                <p>{{provision_cart.project.comment}}</p>
                            </div>
                            <div class="col-8 col-sm-6 d-flex justify-content-end mt-75">
                                <ul class="list-group cost-list">
                                    <li class="list-group-item each-cost border-0 p-50 d-flex justify-content-between">
                                        <span class="cost-title mr-2">{% trans "Total provisioned" %} </span>
                                        <span class="cost-value">$ {{provision_cart.project.budget|intcomma}}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- buttons section -->
        <div class="col-xl-3 col-md-4 col-12 action-btns">
            <div class="card">
                <div class="card-body p-2">
                    <a href="#" class="btn btn-primary btn-block mb-1 print-invoice"> <i class="feather icon-printer mr-25 common-size"></i> {% trans "Print" %}</a>
                    <a href="{% url 'budget_provision_list' %}" class="btn btn-info btn-block mb-1"><i class="feather icon-list mr-25 common-size"></i> {% trans "Go to list" %}</a>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    // Obtén el elemento del contenedor
    var qrcodeContainer = document.getElementById('qrcode');

    // Crea un nuevo objeto QRCode con la información que deseas codificar
    var qrcode = new QRCode(qrcodeContainer, {
      text: 'https://www.ejemplo.com', // Puedes cambiar esta URL por la que desees
      width: 80,
      height: 80,
    });
  </script>
{% endblock content %}
